<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terima Kasih - KPU Monasmuda Institute</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }
        .celebration-animation {
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }
        .fade-in {
            animation: fadeIn 1s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-green-50 min-h-screen">
    <div class="min-h-screen flex items-center justify-center px-4 sm:px-6 lg:px-8">
        <div class="max-w-md w-full space-y-8 text-center">
            <!-- Success Icon -->
            <div class="celebration-animation">
                <div class="mx-auto w-24 h-24 bg-green-100 rounded-full flex items-center justify-center">
                    <svg class="w-12 h-12 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </div>
            </div>

            <!-- Main Content -->
            <div class="fade-in">
                <h1 class="text-4xl font-bold text-gray-900 mb-4">Terima Kasih!</h1>
                <p class="text-xl text-gray-600 mb-8">
                    Suara Anda telah berhasil tercatat dalam sistem pemilihan KPU Monasmuda Institute.
                </p>
            </div>

            <!-- Vote Confirmation -->
            <div class="fade-in bg-white rounded-lg shadow-lg p-6 border border-gray-200">
                <div class="flex items-center justify-center mb-4">
                    <img src="kandidat/kpulogo.jpg" alt="KPU Monasmuda Institute" class="w-8 h-8 rounded-lg object-cover border border-red-200 mr-3" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                    <div class="w-8 h-8 bg-red-600 rounded-lg flex items-center justify-center mr-3" style="display: none;">
                        <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <h2 class="text-lg font-semibold text-gray-900">Konfirmasi Pemilihan</h2>
                </div>

                <div class="space-y-3 text-left">
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600">ID Pemilih:</span>
                        <span class="font-medium text-gray-900" id="voter-id">VT-2024-001247</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600">Waktu Pemilihan:</span>
                        <span class="font-medium text-gray-900" id="vote-time"></span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600">Status:</span>
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                            Berhasil Tercatat
                        </span>
                    </div>
                </div>

                <!-- Vote Summary -->
                <div id="voteSummary" class="mt-4 p-4 bg-gray-50 rounded-lg">
                    <h4 class="font-semibold text-gray-900 mb-3">Distribusi Suara Anda:</h4>

                    <!-- Presiden & Wakil Presiden -->
                    <div class="mb-4">
                        <h5 class="font-medium text-gray-800 mb-2">Presiden & Wakil Presiden</h5>
                        <div id="presiden-votes" class="space-y-1 text-sm pl-4">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Perdana Menteri -->
                    <div class="mb-4">
                        <h5 class="font-medium text-gray-800 mb-2">Perdana Menteri</h5>
                        <div id="pm-votes" class="space-y-1 text-sm pl-4">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Ketua Parlemen -->
                    <div class="mb-4">
                        <h5 class="font-medium text-gray-800 mb-2">Ketua Parlemen</h5>
                        <div id="parlemen-votes" class="space-y-1 text-sm pl-4">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Total Summary -->
                    <div class="border-t pt-3 mt-3">
                        <div class="flex justify-between text-sm font-medium">
                            <span class="text-gray-600">Total Suara Diberikan:</span>
                            <span id="total-votes" class="text-gray-900">-</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Important Information -->
            <div class="fade-in bg-red-50 rounded-lg p-6 border border-red-200">
                <div class="flex items-start">
                    <div class="flex-shrink-0">
                        <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <div class="ml-3">
                        <h3 class="text-sm font-medium text-red-800">Informasi Penting</h3>
                        <div class="mt-2 text-sm text-red-700">
                            <ul class="list-disc list-inside space-y-1">
                                <li>Suara Anda telah dienkripsi dan disimpan dengan aman</li>
                                <li>Hasil pemilihan akan diumumkan setelah periode voting berakhir</li>
                                <li>Anda tidak dapat mengubah pilihan setelah suara dikirim</li>
                                <li>Simpan ID pemilih Anda untuk referensi</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="fade-in space-y-4">
                <a href="index.html" class="w-full bg-red-600 hover:bg-red-700 text-white py-3 px-6 rounded-lg font-medium transition-colors duration-200 inline-block">
                    Kembali ke Beranda
                </a>

                <div class="flex space-x-4">
                    <button onclick="printConfirmation()" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-lg font-medium transition-colors duration-200">
                        Cetak Konfirmasi
                    </button>
                    <button onclick="shareResult()" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg font-medium transition-colors duration-200">
                        Bagikan
                    </button>
                </div>
            </div>

            <!-- Footer Message -->
            <div class="fade-in text-center">
                <p class="text-sm text-gray-500">
                    Partisipasi Anda sangat berarti untuk kemajuan demokrasi di lingkungan akademik.
                </p>
                <p class="text-xs text-gray-400 mt-2">
                    Developed by Muhammad Eden Luqmanul Hakim for KPU Monasmuda Institute Â© 2025
                </p>
            </div>
        </div>
    </div>

    <!-- Confetti Animation (Optional) -->
    <div id="confetti-container" class="fixed inset-0 pointer-events-none z-10"></div>

    <script>
        // Set current time
        document.getElementById('vote-time').textContent = new Date().toLocaleString('id-ID', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        });

        // Load and display vote data
        const voteData = localStorage.getItem('voteData');
        if (voteData) {
            const data = JSON.parse(voteData);

            // Get user quota from current user data or vote data
            let userQuota = 20; // default

            // Try to get quota from current user
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            if (currentUser && currentUser.voteCount) {
                userQuota = currentUser.voteCount;
            }

            // If no current user, try to get from vote data
            if (!currentUser.voteCount && data.userQuota) {
                userQuota = data.userQuota;
            }

            // If still no quota, try to get from user data in admin system
            if (!userQuota || userQuota === 20) {
                const users = JSON.parse(localStorage.getItem('kpu_users') || '[]');
                const voter = users.find(user => user.username === data.username);
                if (voter && voter.voteCount) {
                    userQuota = voter.voteCount;
                }
            }

            console.log('ð Thank you page - User quota:', userQuota);
            console.log('ð Vote data:', data);

            // Display Presiden votes
            const presidenContainer = document.getElementById('presiden-votes');
            let presidenHTML = '';
            Object.entries(data.presidenVotes).forEach(([name, votes]) => {
                if (votes > 0) {
                    presidenHTML += `<div class="flex justify-between"><span>â¢ ${name}:</span><span class="font-medium">${votes} suara</span></div>`;
                }
            });
            presidenHTML += `<div class="flex justify-between font-medium text-red-600 border-t pt-1 mt-1"><span>Total:</span><span>${data.totals.presiden}/${userQuota} suara</span></div>`;
            presidenContainer.innerHTML = presidenHTML;

            // Display PM votes
            const pmContainer = document.getElementById('pm-votes');
            let pmHTML = '';
            Object.entries(data.pmVotes).forEach(([name, votes]) => {
                if (votes > 0) {
                    pmHTML += `<div class="flex justify-between"><span>â¢ ${name}:</span><span class="font-medium">${votes} suara</span></div>`;
                }
            });
            pmHTML += `<div class="flex justify-between font-medium text-green-600 border-t pt-1 mt-1"><span>Total:</span><span>${data.totals.pm}/${userQuota} suara</span></div>`;
            pmContainer.innerHTML = pmHTML;

            // Display Parlemen votes
            const parlemenContainer = document.getElementById('parlemen-votes');
            let parlemenHTML = '';
            Object.entries(data.parlemenVotes).forEach(([name, votes]) => {
                if (votes > 0) {
                    parlemenHTML += `<div class="flex justify-between"><span>â¢ ${name}:</span><span class="font-medium">${votes} suara</span></div>`;
                }
            });
            parlemenHTML += `<div class="flex justify-between font-medium text-purple-600 border-t pt-1 mt-1"><span>Total:</span><span>${data.totals.parlemen}/${userQuota} suara</span></div>`;
            parlemenContainer.innerHTML = parlemenHTML;

            // Display grand total
            const grandTotal = data.totals.presiden + data.totals.pm + data.totals.parlemen;
            const maxTotal = userQuota * 3; // 3 kategori
            document.getElementById('total-votes').textContent = `${grandTotal}/${maxTotal} suara`;
        }

        // Print confirmation function
        function printConfirmation() {
            window.print();
        }

        // Share result function
        function shareResult() {
            if (navigator.share) {
                navigator.share({
                    title: 'Saya telah memberikan suara!',
                    text: 'Saya telah berpartisipasi dalam pemilihan KPU Monasmuda Institute. Mari berpartisipasi dalam demokrasi!',
                    url: window.location.origin
                });
            } else {
                // Fallback for browsers that don't support Web Share API
                const text = 'Saya telah berpartisipasi dalam pemilihan KPU Monasmuda Institute. Mari berpartisipasi dalam demokrasi! ' + window.location.origin;
                navigator.clipboard.writeText(text).then(() => {
                    alert('Link telah disalin ke clipboard!');
                });
            }
        }

        // Simple confetti animation
        function createConfetti() {
            const colors = ['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6'];
            const confettiContainer = document.getElementById('confetti-container');

            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.style.position = 'absolute';
                confetti.style.width = '10px';
                confetti.style.height = '10px';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.top = '-10px';
                confetti.style.borderRadius = '50%';
                confetti.style.animation = `fall ${Math.random() * 3 + 2}s linear forwards`;

                confettiContainer.appendChild(confetti);

                setTimeout(() => {
                    confetti.remove();
                }, 5000);
            }
        }

        // Add CSS for confetti animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fall {
                to {
                    transform: translateY(100vh) rotate(360deg);
                }
            }
        `;
        document.head.appendChild(style);

        // Trigger confetti on page load
        setTimeout(createConfetti, 500);

        // Prevent back button
        history.pushState(null, null, location.href);
        window.onpopstate = function () {
            history.go(1);
        };
    </script>
</body>
</html>
